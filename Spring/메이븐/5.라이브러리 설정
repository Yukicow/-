



저번에 웹 프로젝트로 프로젝트를 변경했다. 

웹 프로젝트의 경우 여러 가지 라이브러리를 필요로 하는데 

그 라이브러리 설정을 해 보고 오류에 대한 내용까지 다뤄 볼 것이다. 




우리가 웹 개발을 할 때에 필요한 라이브러리는 좀 많다.

jdbc도 필요하고 서블릿,jsp,EL태그 등등 필요한 라이브러리가 많아서 우리의 프로젝트에 매번 설정해 주었었다.

근데 물론 프로젝트에 또 설정해 주어도 괜찮은데 그렇게 되면 만약에 회사에서 작업하던 걸 집에서 작업한다고 했을 때

회사에서는 회사 컴퓨터 내에 있는 디렉토리에서 라이브러리를 가져온 것이기 때문에 집에 오면 결국 설정을 다시 해 주어야 한다.

설정이 깨진다는 것이다. 그렇다고 프로젝트에 라이브러리를 포함하는 형태로 하기에는 너무 비효율적이다.

메이븐은 정말정말 친절하게도 이것 조차 해결해 준다.



메이븐에는 Maven 저장소라는 것이 있다. 

메이븐이 운영하는 원격저장소, 원격저장소에서 다운받아서 우리 컴퓨터에 저장되는 로컬 저장소가 있다.

# 로컬 저장소의 경로는 사용자 계정 home 디렉토리의 .m2 폴더의 repository 폴더이다.

원경 저장소는 다른 사람들이 올린 템플릿이나 여러 가지 라이브러리 등이 저장된 곳이다.

그 곳으로 부터 우리는 라이브러리를 다운 받을 것인데 이렇게 다운 받아진 라이브러리를 로컬 저장소에 저장된다.

그리고 우리가 이 로컬 저장소를 이클립스에서 라이브러리 패스로 사용하면 하나의 공간에 그 동안 다운 받은 모든 라이브러리가 있기 때문에

굳이 모든 프로젝트마다 라이브러리를 쳐 넣을 필요 없이 그 로컬 저장소 하나에서 모두 공유해서 쓰면 된다. 

아주 편리하다.


그럼 이제 다운받는 법만 알면 되는데 다운도 간단하다.

원격 저장소, 즉, Maven repository라는 사이트로 가서 다운 받으면 된다.

우리는 jsp 라이브러리를 검색해서 다운 받으면 되는데 문제는 어떤 버전을 다운 받아야할 지 감이 잘 안 잡힌다는 것이다.

우리는 직접 다운받은 것이 아니고 톰캣을 다운 받을 때 같이 다운받아졌고 원래는 그걸 사용했기 때문이다.

그럴 때에는 톰캣 사이트로 가서 우리가 다운받은 버전을 클릭하고 왼쪽 하단에 Reference를 보면

그 버전과 호환되는 라이브러리 버전이 적혀 있다. 그거에 맞게 다운 받으면 된다.


하지만 위의 방법도 조금 귀찮은 방법이다.

그래서 우리는 그냥 톰캣 버전에 맞게 알아서 다운받아졌으면 좋겠다.

그래서 Maven repository사이트에서 검색을 할 때에 앞에 Tomcat을 붙여서 검색할 것이다.

tomcat jsp라고 검색하면 tomcat 버전에 따라 jsp 라이브러리를 정리해 둔 것이 나온다.

우리가 사용하는 톰캣 버전을 클릭하고 들어가면 된다.


이제 다운을 받으면 되는데 직접 다운받는 방법도 있지만 pom.xml에 태그로 다운받는 방법도 있다.

우리가 선택한 라이브러리 화면에서 중간에 보면 빌드 툴들이 나열되어 있는 것이 보일 것이다.

제일 먼저 Maven이 선택되어 있는데 그 밑에 보면 태그가 있다.

그걸 클릭하면 그 태그 내용들이 복사가 되는데 그 복사된 것을 pom.xml에 dependencies 태그에 넣고 저장하면 

우리가 원하는 라이브러리가 자동으로 로컬 저장소에 다운로드 된다.

심지어 개꿀인 것은 그 라이브러리를 사용하기 위한 다른 라이브러리들도 버전에 맞게 함께 다운받아 준다.


잘 다운로드 되었는 지 로컬 저장소에 가서 확인해 보아도 되고 

이클립스의 프로젝트 라이브러리에서 Maven Dependencies(로컬 저장소)를 확인해 봐도 좋다.

아마 jsp 라이브러리와 함께 다른 부가적인 라이브러리가 같이 잘 다운받아졌을 것이다.



위처럼 직접 메이븐 저장소 사이트에서 가서 다운해 주는 방법도 있는데

그냥 이클립스 내에서 메이븐 저장소에 있는 라이브러리를 다운받는 방법도 있다.

이클립스에서 pom.xml에 들어가 보면 밑에 작게 콘솔창처럼 Overview,Dependencies,Dependency 등이 있다.

거기서 Dependencies를 클릭하면 라이브러리를 추가할 수 있는 UI가 나오는데 

Dependencies의 Add를 클릭하면 무슨 창이 뜬다. 라이브러리를 검색하라는 입력공간이 있는데 

그 곳에 우리가 메이븐 저장소에서 검색했듯이 검색하면 라이브러리가 뜬다.


하지만 우리는 안 뜰 것이다.

왜냐하면 이게 뜨기 위해서는 라이브러리에 대한 index를 가져야 하는데

그 작업은 따로 해 주어야 하기 때문이다. 

저장소에 있는 모든 라이브러리에 대한 인덱스 목록이 필요하다는 것이다.

이클립스에서 Maven repository 아이콘을 클릭하면 여러 repository가 뜨는데

그 중에서 Global repository를 선택하면 Central이 보일 것이다. 

그것을 오른쪽 클릭하고 rebuild index를 누르면 라이브러리의 인덱스를 다운받기 시작한다.


만약 Maven repository 아이콘이 안 보인다면 window에서 Show view 에서 

others -> Maven -> maven repository를 선택해 주면 뜬다.


근데 만약 내가 만든 라이브러리를 사용하고 싶을 때에는 어떻게 해야 할까.

아까 위에서 Global repository는 원격 저장소에 저장된 라이브러리들에 대한 index를 갖는다.

하지만 Local repository는 로컬 저장소에 대한 index를 갖기 때문에 우리가 라이브러리를 만들면

로컬 저장소에 그걸 저장하고 가져다 쓰면 될 것이다.


메이븐의 Phase 중에 install과 deploy가 있다. 

install은 로컬 저장소에 패키지를 저장하는 단계이고 deploy는 원격 저장소에 패키지를 저장하는 단계이다.

그럼 우리는 install을 통해서 우리가 만든 프로젝트를 패키지화 하고 로컬 저장소에 저장할 수 있을 것이다.


우리가 만들고자 하는 라이브러리를 만들고 커맨드 창을 통해 그 프로젝트를 install 해도 되고

이클립스 내에서 프로젝트를 우클릭하고 run as -> Maven install을 선택해도 된다.

그렇게 install이 끝나고 나면 로컬 저장소에는 우리가 만들 프로젝트가 패키지화(jar) 되어 저장되어 있을 것이다.

그럼 다른 라이브러리를 가져다 쓰듯이 Dependencies에서 Add를 통해 Local repository에서 찾아 넣기만 하면 된다.

아마 바로 Add 하려고 하면 찾지 못 할 수도 있는데 그럴 때에는 Local repository를 rebuild index해서 업데이트 하면 된다.




라이브러리 오류


메이븐 pom.xml파일을 통해 라이브러리를 다운 받을 경우

다운을 받았음에도 제대로 라이브러리가 동작하지 않는 경우가 있다고 한다.

그것은 라이브러리가 제대로 다운받아지지 않고 깨져서 나타나는 현상인데

아무래도 웹에서 다운받는 형태이다 보니 다운 중에 링크가 깨지거나 파일이 깨지는 등 문제가 발생하기도 하는 듯 하다.


이럴 경우에는 이클립스 종료 후 .m2 디렉토리의 repository 폴더 안의 내용을 모두 지우고

다시 이클립스를 실행하면 자동으로 다시 다운받아진다. 

그러고 나면 제대로 동작하게 될 것이다.